

# 1. 环境搭建

工具链：

- rustc：编译

- cargo：工程管理

  

## 1.1 安装

Rustup 是官方安装器和版本管理工具。通过 Rustup 可以轻松安装、更新和管理 Rust 编译器和工具链的不同版本。

官网安装页面： https://www.rust-lang.org/learn/get-started

通过命令安装：

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```



## 1.2 环境变量

```bash
# Unix-like
export PATH="$HOME/.cargo/bin:$PATH"

# Windows
%USERPROFILE%/.cargo/bin
```



## 1.3 验证

```bash
rustc --version

# 编译
rustc main.rs
```



# 2. 工程管理

## 2.1 cargo

Cargo 是 Rust包管理器和构建系统，管理依赖、编译代码和运行测试

```bash
# 创建二进制应用工程，工程下自动创建 Cargo.toml 文件，功能类似 Node.js 的 package.json
cargo new hello-world --bin

# 创建Rust库工程，默认在 src 下生成 lib.rs 文件
cargo new common-lib

# 编译工程，在target下生成debug目录
cargo build

# 发布项目，在target下生成release目录
cargo build --release

# 运行程序
cargo run
```



| 命令                           | 描述                                                         |
| :----------------------------- | :----------------------------------------------------------- |
| `cargo init`                   | 可以为最新版本创建一个新项目                                 |
| `cargo build`                  | 编译项目及其依赖`--release`                                  |
| `cargo check`                  | 快速检查代码以确保它可以编译，但不生成可执行文件，快速编译检查 |
| `cargo test`                   | 运行项目的测试                                               |
| `cargo doc --open`             | 在本地生成代码和依赖项的文档                                 |
| `cargo run`                    | 如果生成了二进制文件 (main.rs)，                             |
| `cargo run --bin b`            | 运行项目中指定的二进制目标                                   |
| `cargo run -p w`               | 该命令用于在 Rust 的 Cargo 工作空间中运行指定的包            |
| `cargo … --timings`            | 展示是什么包导致你的构建花费了这么长时间。                   |
| `cargo tree`                   | 显示依赖图。                                                 |
| `cargo +{nightly, stable} …`   | `cargo +nightly`：使用 nightly 工具链执行后续的 Cargo 命令；`cargo +stable`：使用 stable 工具链执行后续的 Cargo 命令 |
| `cargo +nightly …`             | 一些仅限夜间的命令（`…`用下面的命令替换）                    |
| `rustc -- -Zunpretty=expanded` | 显示展开的宏。                                               |
| `rustup doc`                   | 打开离线 Rust 文档（包括书籍）                               |
| `cargo add`                    | 向项目添加新的依赖                                           |
| `cargo publish`                | 将包发布到 crates.io                                         |
| `cargo update`                 | 更新 `Cargo.lock` 文件中的依赖项到最新兼容版本               |
| `cargo rm`                     | 从项目中移除依赖（也需 `cargo-edit`）                        |
| `cargo new`                    | 创建一个新的 Rust 项目                                       |
| `cargo watch`                  | 插件，cargo watch 监视你的项目源文件，并在源文件更改时运行 Cargo命令。 |
| `cargo edit`                   | 允许您直接从命令行添加、升级和删除依赖项，而无需手动编辑 `Cargo.toml` 文件。 |
| `cargo modules`                | `cargo-modules` 是一个用于可视化 Rust 项目模块结构的 Cargo 插件。 |
| `cargo make`                   | 高级构建工具和任务运行器，提供了一个扩展的任务定义格式，允许定义更复杂的构建流程和任务（大型项目尤其有用） |
| `cargo Tarpaulin`              | 用于 Rust 项目的代码覆盖率报告工具，让你了解项目测试的覆盖范围，对于维护高质量的代码库非常重要。 |



## 2.2 外部依赖

在 `Cargo.toml` 文件下的 `[dependencies]` 下添加，Cargo 会自动下载所需的依赖包

```toml
[dependencies]
serde = "1.0"
```



## 2.3 换源

修改文件 `~/.cargo/config`，换国内源：

```ini
[source.crates-io]
registry = "https://github.com/rust-lang/crates.io-index"
replace-with = 'rsproxy-sparse'

[source.rsproxy]
registry = "https://rsproxy.cn/crates.io-index"

[source.rsproxy-sparse]
registry = "sparse+https://rsproxy.cn/index/"

[registries.rsproxy]
index = "https://rsproxy.cn/crates.io-index"

[net]
git-fetch-with-cli = true
```







