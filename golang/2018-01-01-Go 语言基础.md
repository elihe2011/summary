

# 4. 获取变量占用的字节数

`unsafe.Sizeof(obj)`

```go
func main() {
	var n = 100
	fmt.Println(unsafe.Sizeof(n))
}
```

# 5. 控制语句

## 5.1 for循环

```go
for {
  
}

for a <= 3 {
  
}

for i := 1; i < 10; i++ {
  
}
```

## 5.2 switch选择

```go
func main() {
	var a = 1

	switch a {
	case 0:
		fmt.Println("a=0")
	case 1:
		fmt.Println("a=1")
	default:
		fmt.Println("No Found")
	}
}

// 不能写成 switch a
func main() {
	var a = 1

	// expression is omitted
	switch {
	case a >= 0:
		fmt.Println("a>=0")
		fallthrough
	case a >= 1:
		fmt.Println("a>=1")
	default:
		fmt.Println("No Found")
	}
}

// a的作用域只在switch中
switch a := 1; {
  
}

// type-switch
func main() {
	var x interface{} = 10

	switch x.(type) {
	case nil:
		fmt.Println("NULL")
	case int:
		fmt.Println("int")
	default:
		fmt.Println("interface{}")
	}
}
```

## 5.3 for循环示例：打印空心金字塔

```go
/*
    *
   * *
  *   *
 *     *
*********
*/

func main() {
	N := 5

	// Step 1: 打印一个n*n列的正方形
	for i := 1; i <= N; i++ {
		// Step 3: 打印等边三角形。每行前补空格：Ln=0, Ln-1=1, L2=n-2, L1=n-1
		for k := 1; k <= N-i; k++ {
			fmt.Print(" ")
		}

		// Step 2: 打印一个直角三角形。金字塔每行*个数：L1=1，L2=3, L3=5, Ln=2n-1
		for j := 1; j <= 2*i-1; j++ {
			// Step 4: 空心。每行只保留第一个和最后一个
			if j == 1 || j == 2*i-1 {
				fmt.Print("*")
			} else {
				// Step 5: 最后一行全部保留
				if i == N {
					fmt.Print("*")
				} else {
					fmt.Print(" ")
				}
			}
		}
		fmt.Println()
	}
}
```

## 5.4 for循环示例：九九乘法表

```go
func main() {
	for i := 1; i <= 9; i++ {
		for j := 1; j <= i; j++ {
			fmt.Printf("%d * %d = %d\t", j, i, i*j)
		}
		fmt.Println()
	}
}
```

## 5.5 for循环示例：水仙花数

水仙花数是指一个 3 位数，它的每个位上的数字的 3次幂之和等于它本身（例如：1^3 + 5^3+ 3^3 = 153）

```go
/*
三位的水仙花数共有4个：153，370，371，407；
四位的四叶玫瑰数共有3个：1634，8208，9474；
*/

func main() {
	var N int64 = 1000000

	var i int64
	for i = 100; i <= N; i++ {
		if isNarcissusFew(i) {
			fmt.Println(i)
		}
	}
}

func isNarcissusFew(n int64) bool {
	s := strconv.FormatInt(n, 10)
	l := len(s)
	var sum int64 = 0
	for j := n; ; {
		m := j % 10

		sum += int64(math.Pow(float64(m), float64(l)))

		j = j / 10
		if j == 0 {
			break
		}
	}

	return sum == n
}

func isNarcissistic(n int64) bool {
	s := strconv.FormatInt(n, 10)
	l := len(s)

	var sum int64 = 0
	for _, c := range s {
		num, _ := strconv.Atoi(fmt.Sprintf("%c", c))
		sum += int64(math.Pow(float64(num), float64(l)))
	}

	return sum == n
}
```

性能对比：

```bash
go test -bench=. -run=none
goos: darwin
goarch: amd64
pkg: gomod/aaa
BenchmarkIsNarcissistic-4              1        93848583244 ns/op
BenchmarkIsNarcissusFew-4              1        31639945040 ns/op
PASS
ok      gomod/aaa       125.791s
```


## 5.6 goto, break, continue LABEL用法：

```go
func main() {
LABEL1:
  for {
    for i := 0; i < 10; i++ {
      if i > 3 {
        // break LABEL1
        goto LABEL2
      }
    }
  }
  
 LABEL2:
  fmt.Println("OK")
}
```


# 6. 随机数

```go
func main() {
	rand.Seed(time.Now().UnixNano())  // 种子变化越大，随机性越好
	n := rand.Intn(100) + 1
	fmt.Println(n)
}
```

# 7. 时间和日期函数

```go
func main() {
	now := time.Now()  // time.Time

	year := now.Year()
	month := int(now.Month())
	day := now.Day()
	fmt.Printf("%04d-%02d-%02d\n", year, month, day)

	weekday := now.Weekday()
	fmt.Println(weekday)

	ts := now.Unix() // timestamp
	nano := now.UnixNano()
	fmt.Println(ts, nano)

	dateStr := now.Format("2006-01-02 15:04:05")
	fmt.Println(dateStr)
}

time.Sleep(100 * time.MilliSecond)
```





